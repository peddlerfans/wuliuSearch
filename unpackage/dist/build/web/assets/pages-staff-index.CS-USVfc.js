import{_ as a,r as e,l as s,c as t,a as l,w as c,i as n,o,b as u,m as i,p as r,F as d,d as f,q as m,t as p,u as _,v,x as y,s as b,n as g,e as k,y as x,z as h,A as w,j as C}from"./index-BBGbeg9X.js";import{s as N}from"./staff.BqUmirh_.js";import"./api.Cc_zTE61.js";const T=a({__name:"index",setup(a){const T=[{label:"全部",value:"all"},{label:"待签收",value:1},{label:"有异议",value:3},{label:"已签收",value:2},{label:"已作废",value:0}],j=e("all"),z=e([]);s((()=>{N({page:1,size:50}).then((a=>{a&&a.data&&(z.value=a.data.map((a=>({id:a.id,trade_no:a.trade_no,companyName:a.company_name,packerName:a.packer_name,inspectorName:a.inspector_name,createTime:a.create_time,status:a.status,remark:a.remark}))))})).catch((a=>{console.error("获取运单列表失败",a)}))}));const S={0:{text:"已作废",class:"abandoned"},1:{text:"待签收",class:"pending"},2:{text:"已签收",class:"signed"},3:{text:"有异议",class:"questioned"}},q=t((()=>"all"===j.value?z.value.map(A):z.value.filter((a=>String(a.status)===String(j.value))).map(A)));function A(a){const e=S[a.status]||{};return{...a,statusText:e.text||"",statusClass:e.class||""}}function F(){p({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:a=>{_({title:"上传中..."}),v({url:"https://djtestweb.youyong.org.cn/api/upload/image",filePath:a.tempFilePaths[0],header:{Authorization:"Bearer "+y("token")},name:"file",success:a=>{try{const e=JSON.parse(a.data);200!==e.code&&0!==e.code||!e.data?k({title:"上传失败："+(e.msg||"未知错误"),icon:"none"}):(b("uploadData",e.data),g({url:"/pages/staff/uploadImg"}))}catch(e){console.error("解析失败",e),k({title:"返回数据异常",icon:"none"})}x()},fail:a=>{console.error("上传失败",a),x(),k({title:"上传失败",icon:"none"})}})}})}return(a,e)=>{const s=n,t=C;return o(),l(s,{class:"staff-page"},{default:c((()=>[u(s,{class:"tabs"},{default:c((()=>[(o(),i(d,null,r(T,((a,e)=>u(s,{key:a.value,class:h(["tab",{active:j.value===a.value}]),onClick:e=>j.value=a.value},{default:c((()=>[f(w(a.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1}),u(s,{class:"waybill-list"},{default:c((()=>[(o(!0),i(d,null,r(q.value,(a=>(o(),l(s,{key:a.id,class:"waybill-item"},{default:c((()=>[u(s,{class:"waybill-header"},{default:c((()=>[u(t,{class:"waybill-no"},{default:c((()=>[f(w(a.trade_no),1)])),_:2},1024),u(t,{class:"company-name"},{default:c((()=>[f(w(a.companyName),1)])),_:2},1024)])),_:2},1024),u(s,{class:"waybill-info"},{default:c((()=>[u(s,{class:"info-left"},{default:c((()=>[u(t,{class:"packer"},{default:c((()=>[f("打包: "+w(a.packerName),1)])),_:2},1024),u(t,{class:"inspector"},{default:c((()=>[f("验货: "+w(a.inspectorName),1)])),_:2},1024)])),_:2},1024),u(s,{class:"info-left"},{default:c((()=>[u(t,{class:"create-time"},{default:c((()=>[f(w(a.createTime),1)])),_:2},1024),u(t,{class:h(["status",a.statusClass])},{default:c((()=>[f(w(a.statusText),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1024),u(s,{class:"info-right",onClick:e=>function(a){g({url:`/pages/staff/detail?trade_no=${a.trade_no}`})}(a)},{default:c((()=>[u(t,null,{default:c((()=>[f("详情")])),_:1}),u(t,{class:"arrow"},{default:c((()=>[f("➔")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),0===q.value.length?(o(),l(s,{key:0,class:"empty"},{default:c((()=>[f("暂无数据")])),_:1})):m("",!0),u(s,{class:"fixed-btn",onClick:F},{default:c((()=>[f("上传")])),_:1})])),_:1})}}},[["__scopeId","data-v-a3ec5784"]]);export{T as default};

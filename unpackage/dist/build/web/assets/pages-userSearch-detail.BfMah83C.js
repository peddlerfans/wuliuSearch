import{_ as e,r as a,e as l,f as t,s,c as u,w as c,i as d,o as n,a as o,b as v,t as i,g as r,h as _,j as f,k as m,F as h,l as g,m as p,p as k,q as b,u as x,I as y,d as V}from"./index-48tkzOBv.js";import{s as w,c as j}from"./staff.B8MeApKU.js";import"./api.BKjFQra2.js";const C=e({__name:"detail",setup(e){const C=a(""),S=a(null),U=a([]),I=a([]),q=a(""),F=a(""),L=a("");l((e=>{e.trade_no&&(C.value=e.trade_no,B())}));const R=t((()=>!!U.value.length&&U.value.every((e=>I.value.includes(String(e.id)))))),z=()=>{2!=S.value.status&&(R.value?I.value=[]:I.value=U.value.map((e=>String(e.id))),console.log(I.value))},A=e=>{I.value=e.detail.value,console.log(I.value)},B=async()=>{C.value?w({trade_no:C.value}).then((e=>{200==e.code||0==e.code?(S.value=e.data,U.value=S.value.products||[],q.value=S.value.remark||"",F.value=S.value.dept_name||"",L.value=S.value.consignee_name||"",I.value=[]):(s({title:e.msg||"查询失败",icon:"none"}),S.value=null,U.value=[],q.value="",F.value="",L.value="",I.value=[])})).catch((e=>{console.log(e)})):s({title:"请输入运单号",icon:"none"})},D=()=>{F.value?L.value?I.value.length?j({trade_no:C.value,check_ids:I.value.join(","),remark:q.value,dept_name:F.value,consignee_name:L.value}).then((e=>{200==e.code||0==e.code?(s({title:"确认成功",icon:"success"}),S.value=e.data,U.value=e.data.products||[],q.value=e.data.remark||"",F.value=e.data.dept_name||"",L.value=e.data.consignee_name||"",I.value=[]):s({title:e.msg||"确认失败",icon:"none"})})).catch((e=>{console.log(e)})):s({title:"请选择产品",icon:"none"}):s({title:"请输入签收人",icon:"none"}):s({title:"请输入部门",icon:"none"})},E=()=>{g({delta:1})};return(e,a)=>{const l=d,t=p,s=k,g=b,w=x,j=y,C=V;return n(),u(l,{class:"container"},{default:c((()=>[o(l,{class:"result-section"},{default:c((()=>[o(l,{class:"header"},{default:c((()=>[o(l,{class:"left"},{default:c((()=>[v(" 运单号："+i(S.value.trade_no),1)])),_:1}),o(l,{class:r(["right",{signed:2===S.value.status,unsigned:2!==S.value.status}])},{default:c((()=>[v(i(2===S.value.status?"已签收":"待签收"),1)])),_:1},8,["class"])])),_:1}),S.value.consignee_name||S.value.consignee_phone?(n(),u(l,{key:0,class:"receiver-info"},{default:c((()=>[S.value.consignee_name?(n(),u(t,{key:0},{default:c((()=>[v(i(S.value.consignee_name||"-"),1)])),_:1})):_("",!0),S.value.consignee_phone?(n(),u(t,{key:1,style:{"margin-left":"16rpx"}},{default:c((()=>[v("电话："+i(S.value.consignee_phone||"-"),1)])),_:1})):_("",!0)])),_:1})):_("",!0),o(l,{class:"material-info"},{default:c((()=>[v("运单包含物料如下")])),_:1}),o(l,{class:"product-table"},{default:c((()=>[o(g,{onChange:A},{default:c((()=>[o(l,{class:"table-header"},{default:c((()=>[o(l,{class:"th checkbox-th"},{default:c((()=>[o(s,{checked:R.value,disabled:2==S.value.status,class:"checkbox",onClick:z},null,8,["checked","disabled"])])),_:1}),o(l,{class:"th"},{default:c((()=>[v("产品型号")])),_:1}),o(l,{class:"th"},{default:c((()=>[v("技术规范")])),_:1}),o(l,{class:"th"},{default:c((()=>[v("数量")])),_:1}),o(l,{class:"th"},{default:c((()=>[v("单位")])),_:1})])),_:1}),(n(!0),f(h,null,m(U.value,((e,a)=>(n(),u(l,{class:"table-row",key:e.id},{default:c((()=>[o(l,{class:"td checkbox-td"},{default:c((()=>[o(s,{value:String(e.id),disabled:2==S.value.status,checked:2==S.value.status?1==e.status:I.value.includes(String(e.id)),class:"checkbox"},null,8,["value","disabled","checked"])])),_:2},1024),o(l,{class:"td"},{default:c((()=>[v(i(e.product_model),1)])),_:2},1024),o(l,{class:"td"},{default:c((()=>[v(i(e.technical_spec),1)])),_:2},1024),o(l,{class:"td"},{default:c((()=>[v(i(e.product_num),1)])),_:2},1024),o(l,{class:"td"},{default:c((()=>[v(i(e.product_unit),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),o(l,{class:"extra-info"},{default:c((()=>[o(l,{class:"extra-row"},{default:c((()=>[o(t,{class:"label"},{default:c((()=>[v("remark：")])),_:1}),2!==S.value.status?(n(),u(w,{key:0,modelValue:q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>q.value=e),class:"editable remark-textarea",placeholder:"请输入",rows:"4"},null,8,["modelValue"])):(n(),u(t,{key:1},{default:c((()=>[v(i(q.value||"-"),1)])),_:1}))])),_:1}),o(l,{class:"extra-row"},{default:c((()=>[o(l,{class:"label"},{default:c((()=>[o(t,{style:{color:"#f56c6c","margin-right":"4rpx"}},{default:c((()=>[v("*")])),_:1}),v("部门：")])),_:1}),2!==S.value.status?(n(),u(j,{key:0,modelValue:F.value,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value=e),class:"editable",placeholder:"请输入"},null,8,["modelValue"])):(n(),u(t,{key:1},{default:c((()=>[v(i(F.value),1)])),_:1}))])),_:1}),o(l,{class:"extra-row"},{default:c((()=>[o(l,{class:"label"},{default:c((()=>[o(t,{style:{color:"#f56c6c","margin-right":"4rpx"}},{default:c((()=>[v("*")])),_:1}),v("签收人：")])),_:1}),2!==S.value.status?(n(),u(j,{key:0,modelValue:L.value,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value=e),class:"editable",placeholder:"请输入"},null,8,["modelValue"])):(n(),u(t,{key:1},{default:c((()=>[v(i(L.value),1)])),_:1}))])),_:1})])),_:1}),2===S.value.status?(n(),u(l,{key:1,class:"extra-row textRight"},{default:c((()=>[o(l,{class:"label textLabel"},{default:c((()=>[v("反馈时间：")])),_:1}),o(t,null,{default:c((()=>[v(i(S.value.trade_time||"-"),1)])),_:1})])),_:1})):_("",!0),2!==S.value.status?(n(),u(l,{key:2,class:"action-btns"},{default:c((()=>[o(C,{class:"confirm-btn",onClick:D},{default:c((()=>[v("确定")])),_:1}),o(C,{class:"cancel-btn",onClick:E},{default:c((()=>[v("取消")])),_:1})])),_:1})):_("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-7355d6ab"]]);export{C as default};
